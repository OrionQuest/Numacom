
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2.2. Matrices &#8212; CS 323 1.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2.3. Norms" href="norms.html" />
    <link rel="prev" title="2.1. Vectors" href="vectors.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="norms.html" title="2.3. Norms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="vectors.html" title="2.1. Vectors"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CS 323 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="algebra.html" accesskey="U">2. Vector and Matrix Algebra</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="matrices">
<span id="sec-matrices"></span><h1>2.2. Matrices<a class="headerlink" href="#matrices" title="Permalink to this headline">¶</a></h1>
<p>Suppose we have <span class="math">\(n\)</span> vectors <span class="math">\(v^1,v^2,\ldots,v^n\in\mathbb R^m\)</span>.
There are several options available to us for denoting this set, either by writing each
one individually as a separate column vector:</p>
<div class="math">
\[\begin{split}v^1=\left(
    \begin{array}{c}
    v^1_1 \\
    v^1_2 \\
    \vdots \\
    v^1_m
    \end{array}
\right), v^2=\left(
    \begin{array}{c}
    v^2_1 \\
    v^2_2 \\
    \vdots \\
    v^2_m
    \end{array}
\right),\ldots,v^n=\left(
    \begin{array}{c}
    v^n_1 \\
    v^n_2 \\
    \vdots \\
    v^n_m
    \end{array}
\right)\end{split}\]</div>
<p>or by adopting the more efficient notation of combining all of them into a single <span class="math">\(m\times n\)</span> matrix:</p>
<div class="math">
\[\begin{split}\left(
\begin{array}{cccc}
\vert &amp; \vert &amp; &amp; \vert \\
v^1 &amp; v^2 &amp; \ldots &amp; v^n \\
\vert &amp; \vert &amp; &amp; \vert
\end{array}
\right) = \left(
\begin{array}{cccc}
v^1_1 &amp; v^2_1 &amp; \ldots &amp; v^n_1 \\
v^1_2 &amp; v^2_2 &amp; \ldots &amp; v^n_2 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
v^1_m &amp; v^2_m &amp; \ldots &amp; v^n_m
\end{array}
\right)\end{split}\]</div>
<p>In general, an <span class="math">\(m\times n\)</span> matrix <span class="math">\(A\in\mathbb R^{m\times n}\)</span> is written as:</p>
<div class="math">
\[\begin{split}A = \left(
\begin{array}{cccc}
A_{11} &amp; A_{12} &amp; \ldots &amp; A_{1n} \\
A_{21} &amp; A_{22} &amp; \ldots &amp; A_{2n} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
A_{m1} &amp; A_{m2} &amp; \ldots &amp; A_{mn}
\end{array}
\right)\end{split}\]</div>
<p>In the example above, <span class="math">\(A_{ij}=v^j_i\)</span>. <a class="reference external" href="http://www.numpy.org/">NumPy</a> has a <code class="docutils literal"><span class="pre">matrix</span></code> class to conveniently define
<span class="math">\(m\times n\)</span> matrices, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="go">    [4, 5, 6],</span>
<span class="go">    [7, 8, 9]])</span>
</pre></div>
</div>
<p>Note that <a class="reference external" href="http://www.numpy.org/">NumPy</a> defines the individual elements of
the matrix by specifying the rows, <em>not</em> the columns. Such an ordering of the
matrix elements is called a <em>row-major</em> ordering. On the other hand, if the data was specified
column-by-column, it would be called a <em>column-major</em> ordering. You are probably familiar
with the <span class="math">\(n\times n\)</span> <em>identity matrix</em> defined as:</p>
<div class="math">
\[\begin{split}I_{n\times n} = \left(\begin{array}{cccc}
\vert &amp; \vert &amp; &amp; \vert \\
e^1 &amp; e^2 &amp; \ldots &amp; e^n \\
\vert &amp; \vert &amp; &amp; \vert
\end{array}
\right) = \left(\begin{array}{ccccc}
1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; \ldots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; \ldots &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; \ldots &amp; 0 &amp; 1
\end{array}
\right)\end{split}\]</div>
<div class="section" id="matrix-vector-product">
<h2>2.2.1. Matrix-Vector Product<a class="headerlink" href="#matrix-vector-product" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math">\(x\in\mathbb R^{n\times 1}\)</span> be an <span class="math">\(n\)</span>-dimensional column vector
and <span class="math">\(A\in\mathbb R^{m\times n}\)</span> be an <span class="math">\(m\times n\)</span> matrix. The
matrix-vector product <span class="math">\(b=Ax\)</span> is the <span class="math">\(m\)</span>-dimensional vector defined
as:</p>
<div class="math">
\[\begin{split}b = \left(\begin{array}{c}
b_1 \\
b_2 \\
\vdots \\
b_m
\end{array}
\right),\mbox{ where }b_i = \sum_{j=1}^n A_{ij}x_j\mbox{ for all }1\leq i\leq m\end{split}\]</div>
<p>Note that <em>all</em> matrices are <em>linear</em> operators, i.e., if <span class="math">\(x,y\in\mathbb R^{n\times 1}\)</span>
are two arbitrary <span class="math">\(n\)</span>-dimensional vectors, and <span class="math">\(\alpha\in\mathbb R\)</span>
is an arbitrary scalar, then it follows that:</p>
<div class="math">
\[\begin{split}A(x+y) &amp;=&amp; \enspace Ax + Ay \\
A(\alpha x) &amp;=&amp; \enspace \alpha Ax\end{split}\]</div>
<p>Matrix-vector products can be computed in <a class="reference external" href="http://www.numpy.org/">NumPy</a> using
the <code class="docutils literal"><span class="pre">dot</span></code> operator, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">array([ 41,  95, 149])</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Example: Image Blurring</p>
<p>To illustrate the power of the abstraction that matrix-vector products
provide, we will show an example from image processing where we will
blur an image by casting the problem as a matrix-vector multiplication.
However, first we must outline how to read an image in <a class="reference external" href="https://www.python.org/">Python</a>
using the <code class="docutils literal"><span class="pre">matplotlib</span></code> package. Consider reading this <a class="reference external" href="_images/chill.jpg">image</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;chill.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">&lt;matplotlib.image.AxesImage object at 0x7f22b353d390&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The above sequence of commands should display the following image:</p>
<a class="reference internal image-reference" href="_images/color_plot.png"><img alt="_images/color_plot.png" class="align-center" src="_images/color_plot.png" style="width: 609.0px; height: 459.0px;" /></a>
<p>In our case, it is more convenient to operate on grayscale images. We
will use the <a class="reference external" href="http://www.pythonware.com/products/pil/">PIL</a> package in <a class="reference external" href="https://www.python.org/">Python</a>
for this purpose.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;chill.jpg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">&lt;matplotlib.image.AxesImage object at 0x7fa3da005390&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The above commands should display the following image:</p>
<a class="reference internal image-reference" href="_images/grayscale_plot.png"><img alt="_images/grayscale_plot.png" class="align-center" src="_images/grayscale_plot.png" style="width: 609.0px; height: 459.0px;" /></a>
<p>To blur the image, we will perform the following simple operation, which
replaces the grayscale value at every pixel by the weighted average of
its neighbors:</p>
<div class="math">
\[\textsf{pixel} \leftarrow \frac{1}{8}(4\cdot\textsf{pixel} + \textsf{pixel}_\textsf{north} + \textsf{pixel}_\textsf{south} + \textsf{pixel}_\textsf{east} + \textsf{pixel}_\textsf{west})\]</div>
<p>Since our blurring code is substantially more complex than anything else we
have encountered so far, for convenience of execution, we will copy all the
code into a file named <code class="docutils literal"><span class="pre">blur.py</span></code>, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># blur.py</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">lil_matrix</span>

<span class="c1"># read image file</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;chill.jpg&#39;</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">arr</span><span class="o">.</span><span class="n">setflags</span><span class="p">(</span><span class="n">write</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># initialize blurring matrix</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">dofs</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">lil_matrix</span><span class="p">((</span><span class="n">dofs</span><span class="p">,</span><span class="n">dofs</span><span class="p">))</span>
<span class="n">A</span><span class="o">.</span><span class="n">setdiag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dofs</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">/</span><span class="mf">8.</span>
        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">8.</span>
        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">8.</span>
        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">8.</span>
        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">8.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span>

<span class="c1"># Blurring function - converts image to a vector, multiplies by</span>
<span class="c1"># the blurring matrix, and copies the result back into the image</span>
<span class="k">def</span> <span class="nf">blur</span><span class="p">():</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">dofs</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>

<span class="c1"># Execute the blurring function 20 times</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">blur</span><span class="p">()</span>

<span class="c1"># Display the blurred image</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Several new concepts have been introduced in the code above. The image array
<code class="docutils literal"><span class="pre">arr</span></code> can be thought of as a column vector <code class="docutils literal"><span class="pre">x</span></code> so that it can be
multiplied by a matrix. Here, we see the generality of the concept of a
vector – an <span class="math">\(m\times n\)</span> image corresponds to a <span class="math">\(mn\)</span>-dimensional
vector. We first construct a <span class="math">\(mn\times mn\)</span> matrix <span class="math">\(A\)</span> to encode
the blurring action. Since densely allocating this matrix would incur a
substantial memory overhead, we allocate a <em>sparse</em> matrix instead using the
<code class="docutils literal"><span class="pre">scipy.sparse</span></code> package. A sparse matrix only stores non-zero entries in a
matrix, resulting in significant memory savings. The <code class="docutils literal"><span class="pre">lil_matrix</span></code> format
allows us to set individual elements in the matrix, and the <code class="docutils literal"><span class="pre">tocsr</span></code>
function converts it to the <em>compressed sparse row</em> format. Several other
formats are available, as explained <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/sparse.html">here</a>.
The <code class="docutils literal"><span class="pre">blur</span></code> function first converts the <span class="math">\(m\times n\)</span> image array into a
<span class="math">\(mn\times 1\)</span> vector, multiplies it by the blurring matrix,
and stores the result back into the image. We run this function <span class="math">\(20\)</span>
times to exaggerate the overall effect. To run the above code, simply
execute the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">python</span> <span class="n">blur</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>This may take some time depending upon the speed of your computer, because
the size of the matrices and vectors is somewhat large.
Finally, the following blurred result should be displayed upon completion:</p>
<a class="reference internal image-reference" href="_images/blurred_plot.png"><img alt="_images/blurred_plot.png" class="align-center" src="_images/blurred_plot.png" style="width: 609.0px; height: 459.0px;" /></a>
<p>Sparse matrices are extremely useful in practice, because the majority of
matrices encountered in real world applications tend to be sparse. We will
see many more examples of their usage in later sections.</p>
</div>
<p>Suppose we consider the individual columns <span class="math">\(v^1,v^2,\ldots,v^n\)</span> of
<span class="math">\(A\)</span>, as shown above. Then the matrix-vector product <span class="math">\(b\)</span> can be
re-written as a <em>linear combination</em> of the columns of <span class="math">\(A\)</span>, i.e., <span class="math">\(b=Ax=\sum_{i=1}^n x_iv^i\)</span>.
This relation can be schematically depicted as follows:</p>
<div class="math">
\[\begin{split}\left(\begin{array}{c}
\vert \\
b \\
\vert
\end{array}\right) = \left(\begin{array}{cccc}
\vert &amp; \vert &amp; &amp; \vert \\
v^1 &amp; v^2 &amp; \ldots &amp; v^n \\
\vert &amp; \vert &amp; &amp; \vert
\end{array}\right)\left(\begin{array}{c}
x_1 \\
x_2 \\
\vdots \\
x_n
\end{array}\right) = x_1\left(\begin{array}{c}
\vert \\
v^1 \\
\vert
\end{array}\right) + x_2\left(\begin{array}{c}
\vert \\
v^2 \\
\vert
\end{array}\right) + \ldots + x_n\left(\begin{array}{c}
\vert \\
v^n \\
\vert
\end{array}\right)\end{split}\]</div>
<p>Traditionally, we are used to viewing the relation <span class="math">\(Ax=b\)</span> as the <em>action</em>
of <span class="math">\(A\)</span> on <span class="math">\(x\)</span> to produce <span class="math">\(b\)</span>. The equation above is a
different interpretation that suggests, in contrast, that <span class="math">\(x\)</span> acts on
<span class="math">\(A\)</span> to produce <span class="math">\(b\)</span>. The set of all <span class="math">\(m\)</span>-dimensional vectors
<span class="math">\(b\)</span> that can be written as <span class="math">\(Ax\)</span> for some <span class="math">\(n\)</span>-dimensional
vector <span class="math">\(x\)</span> constitute the <em>column space</em> of <span class="math">\(A\)</span>. The <em>rank</em> of
<span class="math">\(A\)</span> is the dimension of its column space, i.e., the number of linearly
independent columns of <span class="math">\(A\)</span>.
Also, note how the dimensions of the result
<span class="math">\(b\)</span> are dependent on the dimensions of <span class="math">\(A\)</span> and <span class="math">\(x\)</span>:</p>
<div class="math">
\[b_{m\times 1} = A_{m\times n}\cdot x_{n\times 1}\]</div>
<p>The “middle” dimension <span class="math">\(n\)</span> has to be the same for both <span class="math">\(A\)</span> and
<span class="math">\(x\)</span> and is consumed as a result of the multiplication. This same principle also applies to the case of multiplying two arbitrary matrices,
i.e., if <span class="math">\(A\in\mathbb R^{m\times n}\)</span> and <span class="math">\(B\in\mathbb R^{n\times
p}\)</span> are two matrices, then their product <span class="math">\(C=A\cdot B\in\mathbb R^{m\times p}\)</span>. The <code class="docutils literal"><span class="pre">dot</span></code> operator
in <a class="reference external" href="http://www.numpy.org/">NumPy</a> can also be used for multiplying two
matrices, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">matrix([[ 1,  2,  3,  4],</span>
<span class="go">        [ 5,  6,  7,  8],</span>
<span class="go">        [ 9, 10, 11, 12]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">matrix([[ 1,  2,  3],</span>
<span class="go">        [ 4,  5,  6],</span>
<span class="go">        [ 7,  8,  9],</span>
<span class="go">        [10, 11, 12]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">matrix([[ 70,  80,  90],</span>
<span class="go">        [158, 184, 210],</span>
<span class="go">        [246, 288, 330]])</span>
</pre></div>
</div>
</div>
<div class="section" id="matrix-transpose">
<h2>2.2.2. Matrix Transpose<a class="headerlink" href="#matrix-transpose" title="Permalink to this headline">¶</a></h2>
<p>Another operator on matrices that is quite useful is the <em>transpose</em> operator.
The transpose of a matrix <span class="math">\(A\in\mathbb R^{m\times n}\)</span> is denoted as
<span class="math">\(A^T\in\mathbb R^{n\times m}\)</span>, and is defined as:</p>
<div class="math">
\[\begin{split}A^T = \left(\begin{array}{cccc}
A_{11} &amp; A_{21} &amp; \ldots &amp; A_{m1} \\
A_{12} &amp; A_{22} &amp; \ldots &amp; A_{m2} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
A_{1n} &amp; A_{2n} &amp; \ldots &amp; A_{mn}
\end{array}\right)\end{split}\]</div>
<p>Thus, <span class="math">\((A^T)_{ij}=A_{ji}\)</span>, i.e., the transpose of a matrix is obtained by
<em>flipping</em> the original matrix over its diagonal. The <code class="docutils literal"><span class="pre">transpose</span></code> operator in <a class="reference external" href="http://www.numpy.org/">NumPy</a>
can be used for computing the transpose of a given matrix, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">matrix([[ 1,  2,  3,  4],</span>
<span class="go">        [ 5,  6,  7,  8],</span>
<span class="go">        [ 9, 10, 11, 12]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">matrix([[ 1,  5,  9],</span>
<span class="go">        [ 2,  6, 10],</span>
<span class="go">        [ 3,  7, 11],</span>
<span class="go">        [ 4,  8, 12]])</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2.2. Matrices</a><ul>
<li><a class="reference internal" href="#matrix-vector-product">2.2.1. Matrix-Vector Product</a></li>
<li><a class="reference internal" href="#matrix-transpose">2.2.2. Matrix Transpose</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="vectors.html"
                        title="previous chapter">2.1. Vectors</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="norms.html"
                        title="next chapter">2.3. Norms</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/matrices.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="norms.html" title="2.3. Norms"
             >next</a> |</li>
        <li class="right" >
          <a href="vectors.html" title="2.1. Vectors"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CS 323 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="algebra.html" >2. Vector and Matrix Algebra</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Mridul Aanjaneya.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>